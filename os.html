<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>hangeumOS</title>
<style>
/* ====== ê¸°ë³¸ ====== */
html, body {
  margin: 0;
  width: 100%;
  height: 100%;
  background: radial-gradient(circle at top, #1c1f2a, #0e1016);
  font-family: "Segoe UI", sans-serif;
  overflow: hidden;
  color: white;
}

/* ====== ë°ìŠ¤í¬í†± ====== */
#desktop {
  position: relative;
  width: 100%;
  height: 100%;
}

/* ====== ì•„ì´ì½˜ ====== */
.desktop-icon {
  position: absolute;
  width: 80px;
  padding: 10px 6px;
  text-align: center;
  border-radius: 10px;
  user-select: none;
  cursor: default;
  transition: background 0.15s, box-shadow 0.15s;
}

.desktop-icon img {
  width: 40px;
  pointer-events: none;
}

.desktop-icon span {
  display: block;
  margin-top: 6px;
  font-size: 12px;
  pointer-events: none;
}

/* ì„ íƒ ìƒíƒœ */
.desktop-icon.selected {
  background: rgba(120,180,255,0.25);
  box-shadow: 0 0 0 1px rgba(120,180,255,0.4);
}

/* ë“œë˜ê·¸ ì¤‘ */
.desktop-icon.dragging {
  opacity: 0.85;
  transform: scale(1.05);
  pointer-events: none;
}

/* ====== ì„ íƒ ë°•ìŠ¤ ====== */
.selection-box {
  position: fixed;
  border: 1px solid rgba(120,180,255,0.9);
  background: rgba(120,180,255,0.25);
  border-radius: 4px;
  pointer-events: none;
  z-index: 9998;
}

/* ====== ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ====== */
.context-menu {
  position: fixed;
  min-width: 170px;
  background: rgba(30,30,30,0.9);
  backdrop-filter: blur(16px);
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.08);
  box-shadow: 0 20px 40px rgba(0,0,0,0.4);
  display: none;
  z-index: 9999;
}

.context-menu ul {
  list-style: none;
  margin: 0;
  padding: 6px;
}

.context-menu li {
  padding: 10px 14px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 13px;
}

.context-menu li:hover {
  background: rgba(255,255,255,0.08);
}

.context-menu .divider {
  height: 1px;
  margin: 6px 0;
  background: rgba(255,255,255,0.1);
  pointer-events: none;
}

/* rename input */
.icon-rename-input {
  width: 100%;
  background: rgba(0,0,0,0.4);
  border: none;
  color: #fff;
  text-align: center;
  font-size: 12px;
  outline: none;
  border-radius: 4px;
}

#taskbar {
  position: fixed;
  bottom: 14px;
  left: 50%;
  transform: translateX(-50%);

  height: 50px;
  min-width: 777px;

  background: var(--bg-panel);
  backdrop-filter: blur(18px);

  border-radius: 20px;

  display: flex;
  justify-content: space-between;
  align-items: center;

  padding: 0 14px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.5);
  border: 2px solid rgba(255,255,255,0.1);
}

.task-btn {
  background: none;
  border: none;
  color: var(--text-main);
  font-size: 18px;
  cursor: pointer;
}

.task-start {
  margin-left: 10px;
  font-weight: bold;
  cursor: default;
  user-select: none;
  padding: 4px 8px;
  border-radius: 6px;
  background: rgba(255,255,255,0.1);
  transition: background 0.2s;
}

.task-start:hover {
  background: rgba(255,255,255,0.2);
  cursor: pointer;
}

.taskbar-right {
  font-size: 13px;
  color: var(--text-sub);
  user-select: none;
  cursor: default;
}

.box {
    padding: 20px;
    text-align: center;
    flex: 1 1 auto;            /* ë°˜ì‘í˜• í¬ê¸° ì¡°ì ˆ */
    min-width: 150px;
}

.divider {
    border-left: 2px solid #ccc; /* ì„¸ë¡œ êµ¬ë¶„ì„  */
    height: auto;                /* ë†’ì´ ìë™ */
}

.popup-overlay {
  display: none; /* ê¸°ë³¸ì€ ìˆ¨ê¹€ */
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: 999;
}
  /* íŒì—…ì°½ ìŠ¤íƒ€ì¼ */
.popup-content {
  background: #ffffff00;
  width: 700px;
  padding: 30px;
  border-radius: 20px; /* ë” ë‘¥ê¸€ê²Œ */
  text-align: center;
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  box-shadow: 0 8px 20px rgba(0,0,0,0.4);
  transition: transform 0.3s ease;
  border: 1px solid rgba(255,255,255,0.2);
  background: rgba(38, 40, 63, 0.445);
  backdrop-filter: blur(10px);
}

.close-btn {
  background: #ffffff;
  color: #333;
  border: none;
  padding: 8px 12px;
  border-radius: 20px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
}

.close-btn:hover {
  background: #f0f0f0;
  transform: scale(1.05);
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.glass-card {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 200px;
  padding: 3px;
  margin: 7px;
  width: calc(33.333% - 14px);
  height: 50px;
}

.glass-card:hover {
  transform: scale(1.1);
  transition: transform 0.2s ease;
}

.glass-card p {
  display: flex;
  justify-content: center; /* ê°€ë¡œ ê°€ìš´ë° */
  align-items: center;     /* ì„¸ë¡œ ê°€ìš´ë° */
  height: 45px;           /* ì„¸ë¡œ ë†’ì´ ì§€ì • */
  margin: 0;
}

.c {
  width: 45px;
  height: 45px;
  background: rgba( 255, 255, 255, 0.15 );
  backdrop-filter: blur( 4.5px );
  box-shadow: 0 8px 32px 0 rgba( 31, 38, 135, 0.37 );
  border: 1px solid rgba( 255, 255, 255, 0.18 );
  border-radius: 50%;
  position: absolute;
  left: 5px;
  top: 5px;
  transition: transform 0.2s;
}

.c p {
    justify-content: center; /* ê°€ë¡œ ê°€ìš´ë° */
    align-items: center;     /* ì„¸ë¡œ ê°€ìš´ë° */
    height: 45px;           /* ì„¸ë¡œ ë†’ì´ ì§€ì • */
}

.c:hover {
  transform: scale(1.1);
}

.st-gls {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(119, 37, 37, 0.2);
  border-radius: 200px;
  padding: 3px;
  margin: -25px 470px;
  width: calc(33.333% - 14px);
  height: 50px;
  gap: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  margin-block-end: 5px;
}

.st-gls:hover {
  background: rgba(92, 29, 29, 0.486);
  cursor: pointer;
  transform: scale(1.05);
  transition: all 0.2s ease;
}

.glass-card-m {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 50px;
  padding: 120px;
  margin: 7px;
  width: calc(33.333% - 14px);
  height: 120px;
  position: absolute;
  right: 0;
  top: 60px;
}
</style>
</head>

<body>
<div id="desktop">

  <!-- ì•„ì´ì½˜ -->
  <div class="desktop-icon" data-id="settings" style="left:40px; top:40px;">
    <img src="https://images.icon-icons.com/1572/PNG/96/3592841-cog-gear-general-machine-office-setting-settings_107765.png" style="width: 32px; height: 32px;">
    <span>Settings</span>
  </div>

  <div class="desktop-icon" data-id="files" style="left:40px; top:140px;">
    <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png" style="width: 32px; height: 32px;">
    <span>Files</span>
  </div>

</div>

<!-- ë°ìŠ¤í¬í†± ìš°í´ë¦­ -->
<div id="desktop-menu" class="context-menu">
  <ul>
    <li data-action="arrange">ğŸ§© Arrange Icons</li>
    <li></li>
    <li data-action="refresh">ğŸ”„ Refresh</li>
  </ul>
</div>

<!-- ì•„ì´ì½˜ ìš°í´ë¦­ -->
<div id="icon-menu" class="context-menu">
  <ul>
    <li data-action="open">ğŸ“‚ Open</li>
    <li data-action="rename">âœ Rename</li>
    <li data-action="delete">ğŸ—‘ Delete</li>
  </ul>
</div>

<div id="taskbar">
  <div class="taskbar-center">
      <span class="task-start" onclick="toggleStartMenu()" id="openPopup">âˆ…</span>
      <span>ã…¤</span>
      |
      <span>ã…¤</span>
      <button class="task-btn" onclick="openApp('settings')">âš™</button>
      <button class="task-btn" onclick="openApp('files')">ğŸ“‚</button>
      <button class="task-btn" onclick="openApp('browser')">ğŸŒ</button>
      <button class="task-btn" onclick="openApp('calculator')">ğŸ”¢</button>
    </div>
    <div class="taskbar-right" id="clock"></div>
</div>

<div class="popup-overlay" id="popup">
    <div class="popup-content">
      
        <button class="close-btn" id="closePopup">â†©</button>
        <div class="glass-card">
          <div class="c"><p>âš™</p></div>
          <p>Settings</p>
        </div>
        <div class="glass-card">
          <div class="c"><p>ğŸŒ</p></div>
          <p>Browser</p>
        </div>
        <div class="glass-card">
          <div class="c"><p>ğŸ”¢</p></div>
          <p>Calculator</p>
        </div>
        <div class="glass-card">
          <div class="c"><p>ğŸµ</p></div>
          <p>Music</p>
        </div>
        <div class="glass-card">
          <div class="c"><p>ğŸ“·</p></div>
          <p>Camera</p>
        </div>
        
        <div class="glass-card">
          <div class="c"><p>ğŸ“</p></div>
          <p>Recycle Bin</p>
        </div>

        <div class="st-gls">
          <p>Shut Down</p>
        </div>
        <br>
        <div class="st-gls">
          <p>Restart</p>
        </div>
        <br>
        <div class="st-gls">
          <p>Sleep</p>
        </div>
        <br>
        <div class="st-gls">
          <p>Log Off</p>
        </div>
        <br>
        <div class="st-gls">
          <p>Lock</p>
        </div>
        <br>
        <div class="glass-card-m">
          <div class="glass-card" style="width: 300px;">
            <p>It's not ready yet! (Coming soon)</p>

          </div>
        </div>
    </div>
</div>

<script>
 const popup = document.getElementById('popup');
    const openBtn = document.getElementById('openPopup');
    const closeBtn = document.getElementById('closePopup');

    // íŒì—… ì—´ê¸°
    openBtn.addEventListener('click', () => {
        popup.style.display = 'block';
    });

    // íŒì—… ë‹«ê¸°
    closeBtn.addEventListener('click', () => {
        popup.style.display = 'none';
    });

    // ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
    window.addEventListener('click', (e) => {
        if (e.target === popup) {
            popup.style.display = 'none';
        }
    });

/* ====== GRID ====== */
const GRID_COLS = 6;
const GRID_X = 100;
const GRID_Y = 100;
const START_X = 40;
const START_Y = 40;

/* ====== ì„ íƒ ====== */
let selectedIcon = null;
let isDragging = false;

function clearSelection() {
  document.querySelectorAll(".desktop-icon.selected")
    .forEach(i => i.classList.remove("selected"));
  selectedIcon = null;
}

function selectIcon(icon) {
  clearSelection();
  icon.classList.add("selected");
  selectedIcon = icon;
}

/* ====== ë”ë¸”í´ë¦­ ====== */
function openApp(id) {
  try {
        let fileMap = {
            "settings": "settings.html",
            "app2": "page2.html",
            "app3": "page3.html"
        };

        if (!fileMap[id]) {
            alert("ì˜ëª»ëœ íŒŒì¼ ìš”ì²­ì…ë‹ˆë‹¤ ì˜¤ë¥˜ ì½”ë“œ: " + "plDn01" + " : " + id);
            return;
        }

        window.open(fileMap[id], "_blank");
    } catch (error) {
        console.error("openApp ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜:", error);
        alert("íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŒŒì¼ì´ ì œê±°ë˜ì—ˆê±°ë‚˜ ì‚¬ìš©ì´ ë¶ˆê°€ëŠ¥í•œ ìƒíƒœì¸ì§€ í™•ì¸í•´ ë³´ì„¸ìš”.");
    }
}

/* ====== ì•„ì´ì½˜ í´ë¦­ ====== */
document.querySelectorAll(".desktop-icon").forEach(icon => {
  icon.addEventListener("click", e => {
    e.stopPropagation();
    selectIcon(icon);
  });

  icon.addEventListener("dblclick", () => {
    if (!isDragging) openApp(icon.dataset.id);
  });
});

/* ====== ë“œë˜ê·¸ ì´ë™ ====== */
let dragTarget = null;
let offsetX = 0, offsetY = 0;

document.addEventListener("mousedown", e => {
  const icon = e.target.closest(".desktop-icon");
  if (!icon || e.button !== 0) return;

  dragTarget = icon;
  selectIcon(icon);

  const r = icon.getBoundingClientRect();
  offsetX = e.clientX - r.left;
  offsetY = e.clientY - r.top;
  isDragging = false;
});

document.addEventListener("mousemove", e => {
  if (!dragTarget) return;
  isDragging = true;
  dragTarget.classList.add("dragging");

  let x = e.clientX - offsetX;
  let y = e.clientY - offsetY;

  dragTarget.style.left = x + "px";
  dragTarget.style.top = y + "px";
});

document.addEventListener("mouseup", () => {
  if (!dragTarget) return;
  dragTarget.classList.remove("dragging");
  snapToGrid(dragTarget);
  dragTarget = null;
  setTimeout(() => isDragging = false, 0);
});

/* ====== ìŠ¤ëƒ… ====== */
function snapToGrid(icon) {
  const x = parseInt(icon.style.left);
  const y = parseInt(icon.style.top);
  const col = Math.round((x - START_X) / GRID_X);
  const row = Math.round((y - START_Y) / GRID_Y);
  icon.style.left = START_X + col * GRID_X + "px";
  icon.style.top = START_Y + row * GRID_Y + "px";
}

/* ====== ë‹¤ì¤‘ ì„ íƒ ë°•ìŠ¤ ====== */
let box = null, sx = 0, sy = 0, selecting = false;

document.addEventListener("mousedown", e => {
  if (e.target.closest(".desktop-icon") || e.button !== 0) return;
  clearSelection();
  selecting = true;
  sx = e.clientX; sy = e.clientY;

  box = document.createElement("div");
  box.className = "selection-box";
  document.body.appendChild(box);
});

document.addEventListener("mousemove", e => {
  if (!selecting || !box) return;

  const x = Math.min(sx, e.clientX);
  const y = Math.min(sy, e.clientY);
  const w = Math.abs(e.clientX - sx);
  const h = Math.abs(e.clientY - sy);

  Object.assign(box.style, {
    left: x + "px", top: y + "px",
    width: w + "px", height: h + "px"
  });

  document.querySelectorAll(".desktop-icon").forEach(icon => {
    const r = icon.getBoundingClientRect();
    const hit = r.left < x+w && r.right > x && r.top < y+h && r.bottom > y;
    icon.classList.toggle("selected", hit);
  });
});

document.addEventListener("mouseup", () => {
  selecting = false;
  if (box) box.remove();
  box = null;
});

/* ====== ìš°í´ë¦­ ë©”ë‰´ ====== */
const desktopMenu = document.getElementById("desktop-menu");
const iconMenu = document.getElementById("icon-menu");
let currentIcon = null;

document.addEventListener("contextmenu", e => {
  e.preventDefault();
  desktopMenu.style.display = iconMenu.style.display = "none";

  const icon = e.target.closest(".desktop-icon");
  const menu = icon ? iconMenu : desktopMenu;
  currentIcon = icon;

  if (icon) selectIcon(icon);

  menu.style.left = e.clientX + "px";
  menu.style.top = e.clientY + "px";
  menu.style.display = "block";
});

document.addEventListener("click", () => {
  desktopMenu.style.display = iconMenu.style.display = "none";
});

/* ë©”ë‰´ ì•¡ì…˜ */
iconMenu.onclick = e => {
  const a = e.target.dataset.action;
  if (!a || !currentIcon) return;

  if (a === "open") openApp(currentIcon.dataset.id);
  if (a === "delete") currentIcon.remove();
  if (a === "rename") renameIcon(currentIcon);
};

desktopMenu.onclick = e => {
  if (e.target.dataset.action === "arrange") autoArrangeIcons();
};

function renameIcon(icon) {
  const span = icon.querySelector("span");
  const input = document.createElement("input");
  input.value = span.textContent;
  input.className = "icon-rename-input";
  span.replaceWith(input);
  input.focus();

  input.onblur = () => {
    const s = document.createElement("span");
    s.textContent = input.value;
    input.replaceWith(s);
  };
}

/* ìë™ ì •ë ¬ */
function autoArrangeIcons() {
  document.querySelectorAll(".desktop-icon").forEach((icon, i) => {
    icon.style.left = START_X + (i % GRID_COLS) * GRID_X + "px";
    icon.style.top = START_Y + Math.floor(i / GRID_COLS) * GRID_Y + "px";
  });
}
</script>
</body>
</html>
